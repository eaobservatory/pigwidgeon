{% macro render_commentform(search, paper=None, submitbutton=True) %}

{% if submitbutton is not defined or submitbutton is none %}
<form>
  {% else %}
<form method="POST" action="{{url_for('submit_paper', searchid=search.id, paperid=paper.id)}}">
  {% endif %}
  <div class="formmajor">
    <h2>Please enter your comments</h2>
    {% for ptype in search.papertypes %}
    <label>
      {% if ptype.radio %}
      <input type="radio" name="type" value="{{ptype.name_code}}">
      {% else %}
      <input type="checkbox" name="type" value="{{ptype.name_code}}">
      {% endif %}
      {{ptype.name_}}
    </label><br/>
    {% endfor %}
  </div>
  
  {% for infosection in search.infosections %}
  <div class="ftype">
    <h3>{{infosection.name_}}</h3>
    {% if infosection.type_ == 3 %}
    <textarea name="{{infosection.name_code}}"
	      rows="4"
	      style="width:10em"
	      placeholder="{{infosection.instructiontext}}"></textarea>
    {% elif infosection.type_ == 2 %}
    <textarea name="{{infosection.name_code}}"
	      rows="7"
	      style="width:18em"
	      placeholder="{{infosection.instructiontext}}"></textarea>
    {% endif %}
    {% for sl in infosection.sublists %}
    <input type="checkbox" name="{{infosection.name_code}}" value="{{sl.entry_value}}" id="{{sl.entry_value}}">
    <label for="{{sl.entry_value}}">{{sl.named}}</label><br/>
    {% endfor %}
  </div>
  {% endfor %}
  {% if submit_button %}
  <p><input type="submit" value="Submit"></p>
  {% endif %}
</form>
{% endmacro %}


{% macro render_hidden_searchform(search) %}
<form method="POST" action="{{url_for('create_search')}}">
  <input type="hidden" name="searchname" value="{{search.named}}"/>
  <input type="hidden" name="adsquery" value="{{search.ads_query}}"/>
  {% for i in range(search.papertypes|length) %}
    <input type="hidden" name="ptname" value="{{search.papertypes[i].name_}}"/>
    {% if search.papertypes[i].radio %}
      <input type="hidden" name="ptradio{{(i|int+1)|string}}" value="on"/>
    {% endif %}
  {% endfor %}
  {% for infosec in search.infosections %}
    <input type="hidden" name="infoname" value="{{infosec.name_}}"/>
    <input type="hidden" name="infotext" value="{{infosec.instructiontext}}"/>
    <input type="hidden" name="infotype" value="{{infosec.type_}}"/>
    {% if infosec.sublists %}
      {% for sl in infosec.sublists %}
      <input type="hidden" name="infosublistid" value="{{search.infosections.index(infosec) + 1}}"/>
      <input type="hidden" name="infosublistentry" value="{{sl.named}}"/>
      {% endfor %}
    {% endif %}
  {% endfor %}
  <input type="submit" value="Submit">
</form>
{% endmacro %}


{% macro render_paper(paper) %}
<div id="paperinfo">
  <h1>{{title}}</h1>
  <div id="authors">
    <ul class="horizontal">
      {% for a in paper.authors %}
      <li class="horizitem">{{a.author}}</li>
      {% endfor %}
    </ul>
  </div>
  {% if paper.keywords is defined and paper.keywords is not none %}
  <div id="keywords">
    <ul class="horizontal">
      {% for k in paper.keywords %}
      <li>{{k.keyword}}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  <div id="abstract">
    <p>{{paper.abstract|safe}}</p>
  </div>
  
  <div id="idents" style="display:inline-block">
    <dl class="inline">
      {% if arxiv is defined %}
      <dt>arXiv</dt>
      <dd>
	<a href="http://arxiv.org/abs/{{arxiv}}">
	  {{arxiv}}
	</a>
      </dd>
      {% endif %}
      {% if doi is defined %}
      <dt>DOI</dt>
      <dd>
	<a href="http://dx.doi.org/{{doi}}">
	  {{doi}}
	</a>
      </dd>
      {% endif %}
      <dt>ADS</dt>
      <dd>
	<a href="http://adsabs.harvard.edu/abs/{{paper.bibcode}}">
	  {{paper.bibcode}}
	</a>
      </dd>
    </dl>
  </div>

  <div id="properties">
    <ul class="horizontal" >

      {% if paper.pub_openaccess and paper.pub_openaccess !='' %}
      <li><a href="{{paper.pub_openaccess|pdflink}}">Pub. Open Access link</a></li>
      {% endif %}
      {% if paper.refereed %}
      <li>Refereed</li>
      {% endif %}
    </ul>
  </div>
</div>
{% endmacro %}
